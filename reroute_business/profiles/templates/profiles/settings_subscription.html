{% extends "base.html" %}
{% load static %}

{% block title %}ReRoute | Subscription Settings{% endblock %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/subscription.css' %}">

<section class="settings-hero">
  <div class="settings-hero-content">
    <h1>Subscription</h1>
    <p>Manage your plan and billing status.</p>
  </div>
  <div class="settings-mini-nav">
    <a class="mini-link" href="{% url 'settings' %}">Back to Settings</a>
  </div>
  
</section>

<div class="settings-container">
  <div class="subscription-card">
    <div class="subscription-header">
      <h2>Your Plan</h2>
      <span class="status-pill {% if subscription.active %}active{% else %}inactive{% endif %}">
        {% if subscription.active %}Active{% else %}Inactive{% endif %}
      </span>
    </div>

    <div class="subscription-body">
      <div class="field-row">
        <span class="field-label">Current Plan:</span>
        <span class="field-value">{{ subscription.plan_name }}</span>
      </div>
      {% if subscription.expiry_date %}
      <div class="field-row">
        <span class="field-label">Expires:</span>
        <span class="field-value">{{ subscription.expiry_date|date:"F j, Y" }}</span>
      </div>
      {% endif %}
      <div class="field-row">
        <span class="field-label">Started:</span>
        <span class="field-value">{{ subscription.start_date|date:"F j, Y" }}</span>
      </div>
    </div>

    <div class="subscription-actions">
      <a href="{{ pricing_url }}" class="btn-primary" {% if is_employer and not is_verified %}aria-disabled="true" data-disabled="true"{% endif %}>
        Change Plan
      </a>
      {% if is_employer %}
      <form method="post" action="{% url 'profiles:cancel_subscription' %}" class="inline-form" onsubmit="return confirm('Cancel your subscription and revert to Free?');">
        {% csrf_token %}
        <button type="submit" class="btn-danger">Cancel Subscription</button>
      </form>
      {% endif %}
    </div>

    {% if is_employer and not is_verified %}
      <p class="note warning">Your account must be verified before upgrading your plan.</p>
    {% endif %}

    {% if not is_employer %}
      <p class="note">You have a Free plan as a job seeker.</p>
    {% endif %}
  </div>
</div>
{% endblock %}
