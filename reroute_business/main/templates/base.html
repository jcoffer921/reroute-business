<!DOCTYPE html>
{% load static %}
{% load i18n %}
<html lang="{{ LANGUAGE_CODE }}">
<head>
    <meta charset="UTF-8">
    {# NOTE: no custom template tags needed; context processor provides IS_EMPLOYER + DASHBOARD_URL #}
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{% trans "ReRoute | Home" %}{% endblock %}</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="{% static 'css/low_data_mode.css' %}">
    <link rel="icon" href="{% static 'favicon.ico' %}" type="image/x-icon">
    {% block extra_css %}{% endblock %}
</head>
<body class="{% block body_class %}{% endblock %}{% if LOW_DATA_MODE %} low-data-mode{% endif %}">
    <div class="page-wrapper">
        <!-- =================== NAVBAR (fixed) =================== -->
        <nav class="navbar navbar--auto-hide" data-navbar>
            <div class="navbar-logo">
                <a href="{% url 'home' %}">
                    <img src="{% static 'images/ReRoute-logo-with-tagline-black-bkgd.png' %}" alt="{% trans 'ReRoute Logo' %}" class="brand-logo">
                </a>
            </div>

            <div class="navbar-links-container">
                <!-- ---------- Left-side navigation links ---------- -->
                <div class="nav-links">
                    <a href="{% url 'home' %}">{% trans "Home" %}</a>
                    <a href="{% url 'about_us' %}">{% trans "About" %}</a>
                    <a href="{% url 'benefit_finder:start' %}">{% trans "Benefit Finder" %}</a>
                    <a href="{% url 'journal_home' %}">{% trans "Journal" %}</a>
                    {% if user.is_authenticated %}
                        <a href="{% url 'dashboard:my_dashboard' %}">{% trans "Dashboard" %}</a>
                    {% endif %}
                    <a href="{% url 'opportunities' %}">{% trans "Jobs" %}</a>
                    <a href="{% url 'resource_list' %}">{% trans "Resources" %}</a>
                </div>

                <!-- ---------- Right-side profile menu ---------- -->
                {% if user.is_authenticated %}
                <div class="user-profile-right">
                    <form method="post" action="{% url 'set_language' %}" class="lang-switch-form">
                        {% csrf_token %}
                        <input type="hidden" name="next" value="{{ request.get_full_path }}">
                        {% if LANGUAGE_CODE|slice:":2" == "en" %}
                        <input type="hidden" name="language" value="es">
                        <button type="submit" class="lang-switch-btn" aria-label="{% trans 'Switch language to Spanish' %}">
                            <svg aria-hidden="true" width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-width="2"/>
                                <path d="M2 12H22" stroke="currentColor" stroke-width="2"/>
                                <path d="M12 2C14.5 4.8 16 8.2 16 12C16 15.8 14.5 19.2 12 22C9.5 19.2 8 15.8 8 12C8 8.2 9.5 4.8 12 2Z" stroke="currentColor" stroke-width="2"/>
                            </svg>
                            <span>ES</span>
                        </button>
                        {% else %}
                        <input type="hidden" name="language" value="en">
                        <button type="submit" class="lang-switch-btn" aria-label="{% trans 'Switch language to English' %}">
                            <svg aria-hidden="true" width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-width="2"/>
                                <path d="M2 12H22" stroke="currentColor" stroke-width="2"/>
                                <path d="M12 2C14.5 4.8 16 8.2 16 12C16 15.8 14.5 19.2 12 22C9.5 19.2 8 15.8 8 12C8 8.2 9.5 4.8 12 2Z" stroke="currentColor" stroke-width="2"/>
                            </svg>
                            <span>EN</span>
                        </button>
                        {% endif %}
                    </form>
                    <a href="{% url 'dashboard:notifications' %}" class="notif-bell-link" aria-label="{% trans 'Notifications' %}">
                        <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                            <path d="M6.5 9.8a5.5 5.5 0 1 1 11 0v3.5l1.5 2.6H5l1.5-2.6Z"></path>
                            <path d="M10 18a2 2 0 0 0 4 0"></path>
                            <path d="M12 4.3V3"></path>
                        </svg>
                        {% if UNREAD_NOTIFICATIONS %}
                          <span class="notif-bell-dot" aria-hidden="true"></span>
                        {% endif %}
                    </a>
                    {% if user.is_staff or user.is_superuser %}
                    <span class="admin-role-badge">{% trans "Admin" %}</span>
                    {% endif %}
                    <button class="user-initials-btn user-menu-trigger" id="userMenuButton" aria-expanded="false" aria-controls="userDropdown">
                        <span class="user-menu-icon" aria-hidden="true">
                            <svg viewBox="0 0 24 24" role="img" aria-hidden="true" focusable="false">
                                <circle cx="12" cy="8" r="4"></circle>
                                <path d="M4 20c0-4 4-6 8-6s8 2 8 6"></path>
                            </svg>
                        </span>
                        <span class="user-menu-name">{{ user.first_name|default:user.username }}</span>
                    </button>
                    <div class="user-dropdown" id="userDropdown" aria-label="{% trans 'User menu' %}">
                        <a href="{% url 'dashboard:my_dashboard' %}">{% trans "Dashboard" %}</a>
                        <a href="{{ PUBLIC_PROFILE_URL }}">{% trans "View Profile" %}</a>
                        <a href="{{ PROFILE_URL }}">{% trans "Profile Settings" %}</a>
                        <a href="{% url 'contact' %}">{% trans "Report Issues" %}</a>
                        <a href="{% url 'settings' %}">{% trans "Settings" %}</a>
                        <form method="POST" action="{% url 'logout' %}" class="m-0">
                            {% csrf_token %}
                            <button type="submit" class="logout-btn">{% trans "Sign out" %}</button>
                        </form>
                    </div>
                    </div>
                {% else %}
                <div class="guest-auth-links">
                    <form method="post" action="{% url 'set_language' %}" class="lang-switch-form">
                        {% csrf_token %}
                        <input type="hidden" name="next" value="{{ request.get_full_path }}">
                        {% if LANGUAGE_CODE|slice:":2" == "en" %}
                        <input type="hidden" name="language" value="es">
                        <button type="submit" class="lang-switch-btn" aria-label="{% trans 'Switch language to Spanish' %}">
                            <svg aria-hidden="true" width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-width="2"/>
                                <path d="M2 12H22" stroke="currentColor" stroke-width="2"/>
                                <path d="M12 2C14.5 4.8 16 8.2 16 12C16 15.8 14.5 19.2 12 22C9.5 19.2 8 15.8 8 12C8 8.2 9.5 4.8 12 2Z" stroke="currentColor" stroke-width="2"/>
                            </svg>
                            <span>ES</span>
                        </button>
                        {% else %}
                        <input type="hidden" name="language" value="en">
                        <button type="submit" class="lang-switch-btn" aria-label="{% trans 'Switch language to English' %}">
                            <svg aria-hidden="true" width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-width="2"/>
                                <path d="M2 12H22" stroke="currentColor" stroke-width="2"/>
                                <path d="M12 2C14.5 4.8 16 8.2 16 12C16 15.8 14.5 19.2 12 22C9.5 19.2 8 15.8 8 12C8 8.2 9.5 4.8 12 2Z" stroke="currentColor" stroke-width="2"/>
                            </svg>
                            <span>EN</span>
                        </button>
                        {% endif %}
                    </form>
                    <a href="{% url 'login' %}">{% trans "Sign In" %}</a>
                    <a href="{% url 'signup' %}" class="guest-auth-links__primary">{% trans "Create Account" %}</a>
                </div>
                {% endif %}

                <!-- ---------- Mobile hamburger ---------- -->
                <button class="hamburger" aria-controls="mobileMenu" aria-expanded="false" aria-label="{% trans 'Open menu' %}">☰</button>
            </div>
        </nav>

        <!-- Flash messages (visible below fixed nav) -->
        {% if messages %}
            <div class="flash-messages max-w-4xl mx-auto mt-4 px-4">
                {% for message in messages %}
                    <div class="alert {{ message.tags }}">
                        <span class="alert-text">{{ message }}</span>
                        <button class="close-btn" data-close-alert>&times;</button>
                    </div>
                {% endfor %}
            </div>
        {% endif %}

        <!-- =================== MAIN CONTENT =================== -->
        <main class="content">
            {% block content %}{% endblock %}
        </main>

        <!-- =================== FOOTER =================== -->
        <footer class="site-footer">
            <div class="footer-container">
                <div class="footer-column">
                    <a href="{% url 'home' %}">
                        <img src="{% static 'images/ReRoute-logo-with-tagline-black-bkgd.png' %}" alt="{% trans 'ReRoute Logo' %}" class="footer-logo-img">
                    </a>
                </div>

                <div class="footer-column">
                    <h4>{% trans "Quick Links" %}</h4>
                    <ul>
                        <li><a href="{% url 'about_us' %}">{% trans "About Us" %}</a></li>
                        <li><a href="{% url 'journal_home' %}">{% trans "Journal" %}</a></li>
                        <li><a href="{% url 'contact' %}">{% trans "Contact Us" %}</a></li>
                        <li><a href="{% url 'home' %}">{% trans "Home" %}</a></li>
                        <li><a href="{% url 'opportunities' %}">{% trans "Opportunities" %}</a></li>
                        <li><a href="{% url 'resource_list' %}">{% trans "Resources" %}</a></li>
                        <li><a href="{% url 'faq' %}">{% trans "FAQ" %}</a></li>
                    </ul>
                </div>

                <div class="footer-column">
                    <h4>{% trans "Contact" %}</h4>
                    <p>{% trans "Email:" %} support@reroutejobs.com</p>
                    <p>{% trans "Philadelphia, PA" %}</p>
                </div>
            </div>

            <div class="footer-bottom">
                <p>
                    {% blocktrans %}&copy; 2025 {{ COMPANY_LEGAL_NAME }}. All rights reserved.{% endblocktrans %}
                </p>
                <p>
                  <a href="{% url 'pricing' %}">{% trans "Pricing" %}</a>
                  |
                  <a href="{% url 'privacy' %}">{% trans "Privacy Policy" %}</a>
                  |
                  <a href="{% url 'terms' %}">{% trans "Terms of Use" %}</a>
                  |
                  <a href="{% url 'faq' %}">{% trans "FAQ" %}</a>
                </p>
            </div>
        </footer>
    </div>

    <div id="mobileBackdrop" class="mobile-backdrop" hidden></div>

    <div id="mobileMenu"
        class="mobile-menu"
        role="dialog"
        aria-modal="true"
        aria-hidden="true"
        aria-labelledby="mobileMenuTitle"
        tabindex="-1">
    <div class="mobile-menu-header">
        <span class="mobile-logo">
        <img src="{% static 'images/reroute-logo.png' %}" alt="{% trans 'ReRoute Logo' %}" height="36">
        </span>
        <form method="post" action="{% url 'set_language' %}" class="lang-switch-form lang-switch-form--mobile">
            {% csrf_token %}
            <input type="hidden" name="next" value="{{ request.get_full_path }}">
            {% if LANGUAGE_CODE|slice:":2" == "en" %}
            <input type="hidden" name="language" value="es">
            <button type="submit" class="lang-switch-btn" aria-label="{% trans 'Switch language to Spanish' %}">
                <svg aria-hidden="true" width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-width="2"/>
                    <path d="M2 12H22" stroke="currentColor" stroke-width="2"/>
                    <path d="M12 2C14.5 4.8 16 8.2 16 12C16 15.8 14.5 19.2 12 22C9.5 19.2 8 15.8 8 12C8 8.2 9.5 4.8 12 2Z" stroke="currentColor" stroke-width="2"/>
                </svg>
                <span>ES</span>
            </button>
            {% else %}
            <input type="hidden" name="language" value="en">
            <button type="submit" class="lang-switch-btn" aria-label="{% trans 'Switch language to English' %}">
                <svg aria-hidden="true" width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-width="2"/>
                    <path d="M2 12H22" stroke="currentColor" stroke-width="2"/>
                    <path d="M12 2C14.5 4.8 16 8.2 16 12C16 15.8 14.5 19.2 12 22C9.5 19.2 8 15.8 8 12C8 8.2 9.5 4.8 12 2Z" stroke="currentColor" stroke-width="2"/>
                </svg>
                <span>EN</span>
            </button>
            {% endif %}
        </form>
        <button class="close-btn" data-close-mobile aria-label="{% trans 'Close menu' %}">✕</button>
    </div>

    <h2 id="mobileMenuTitle" class="sr-only">{% trans "Main menu" %}</h2>

    {% if user.is_authenticated %}
    <div class="mobile-quick-actions" role="group" aria-label="{% trans 'Quick actions' %}">
        <a href="{% url 'benefit_finder:start' %}" class="mobile-quick-action mobile-quick-action--primary">{% trans "Benefit Finder" %}</a>
        <a href="{% url 'dashboard:my_dashboard' %}" class="mobile-quick-action">{% trans "Dashboard" %}</a>
        <a href="{% url 'opportunities' %}" class="mobile-quick-action">{% trans "Jobs" %}</a>
    </div>
    {% else %}
    <div class="mobile-quick-actions" role="group" aria-label="{% trans 'Quick actions' %}">
        <a href="{% url 'benefit_finder:start' %}" class="mobile-quick-action mobile-quick-action--primary">{% trans "Benefit Finder" %}</a>
        <a href="{% url 'login' %}" class="mobile-quick-action">{% trans "Sign In" %}</a>
        <a href="{% url 'signup' %}" class="mobile-quick-action">{% trans "Create Account" %}</a>
    </div>
    {% endif %}

    <p class="mobile-nav-section-label">{% trans "Explore" %}</p>
    <ul class="mobile-nav-links">
        <li><a href="{% url 'home' %}">{% trans "Home" %}</a></li>
        <li><a href="{% url 'about_us' %}">{% trans "About" %}</a></li>
        <li><a href="{% url 'benefit_finder:start' %}">{% trans "Benefit Finder" %}</a></li>
        <li><a href="{% url 'journal_home' %}">{% trans "Journal" %}</a></li>
        {% if user.is_authenticated %}
        <li><a href="{% url 'dashboard:my_dashboard' %}">{% trans "Dashboard" %}</a></li>
        {% endif %}
        <li><a href="{% url 'opportunities' %}">{% trans "Jobs" %}</a></li>
        <li><a href="{% url 'resource_list' %}">{% trans "Resources" %}</a></li>
    </ul>

    {% if user.is_authenticated %}
    <div class="mobile-user-footer">
        <a href="{{ PUBLIC_PROFILE_URL }}" class="user-initials-circle" aria-label="{% trans 'Go to your public profile' %}">
        {{ user.first_name|default:user.username|slice:":1" }}{{ user.last_name|default:""|slice:":1" }}
        </a>

        <a href="{{ PUBLIC_PROFILE_URL }}" class="mobile-user-name">
        {{ user.first_name|default:user.username }}
        </a>

        <form method="POST" action="{% url 'logout' %}" class="logout-form">
        {% csrf_token %}
        <button type="submit" class="logout-btn">{% trans "Sign out" %}</button>
        </form>
    </div>
    {% else %}
    <div class="mobile-user-footer guest">
        <div class="user-initials-circle disabled" aria-hidden="true">?</div>
        <span class="mobile-user-name">{% trans "Guest" %}</span>

        <a href="{% url 'login' %}" class="login-btn" data-close-mobile-menu>{% trans "Sign in" %}</a>
        <a href="{% url 'signup' %}" class="signup-btn" data-close-mobile-menu>{% trans "Create account" %}</a>
    </div>
    {% endif %}

    </div>

    <script src="{% static 'js/base.js' %}" defer></script>
    <script src="{% static 'js/mobile_menu.js' %}" defer></script>
    {% block extra_js %}{% endblock %}
</body>
</html>
